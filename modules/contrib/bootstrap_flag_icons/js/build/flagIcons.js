!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.flagIcons=t())}(self,()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/widget.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/widget.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function i(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};return(()=>{"use strict";i.d(s,{default:()=>d});var e=i("ckeditor5/src/core.js"),t=i("ckeditor5/src/ui.js");class o extends t.View{constructor(e){super(e.locale),this.searchInputView=this._createInput("Search icon (ie. France)");const t=e.config.get("flag_icons");let i=t.search_list,s=t.cdn;if(s.length){let e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=s,document.head.appendChild(e)}this.iconsFlag=this._createListIcons(i);const o=this.iconsFlag.items._items;this.searchInputView.fieldView.on("input",e=>{let t=e.source.element.value.toLowerCase().replace(/[_\-+]/g," ").trim();sessionStorage.setItem("flagIconSearch",t),o.forEach(e=>{const i=e.element.innerText.toLowerCase().replace(/[_\-+]/g," ").trim().indexOf(t);e.element.style.display=-1!==i?"block":"none"})}),this.saveButtonView=this._createButton(e.t("Save"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(e.t("Cancel"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',"ck-button-cancel"),this.cancelButtonView.delegate("execute").to(this,"cancel"),this.childViews=this.createCollection([this.searchInputView,this.iconsFlag,this.saveButtonView,this.cancelButtonView]),this.setTemplate({tag:"form",attributes:{class:["ck","ck-flag-form","ck-responsive-form"],tabindex:"-1"},children:this.childViews})}render(){super.render(),(0,t.submitHandler)({view:this})}focus(){this.childViews.first.focus()}_createInput(e){const i=new t.LabeledFieldView(this.locale,t.createLabeledInputText);i.label=e;let s=sessionStorage.getItem("flagIconSearch");return s&&i.fieldView.bind("value").to(this,e=>s),i}_createButton(e,i,s){const o=new t.ButtonView;return o.set({label:e,icon:i,tooltip:!0,class:s}),o}_createIconBtn(e,i){const s=new t.ButtonView;s.set({tooltip:i,class:["ck-reset_all-excluded"]}),s.labelView.setTemplate({tag:"i",children:[i],attributes:{class:["fi","fi-"+e]}}),s.on("execute",()=>{this.searchInputView.fieldView.element.value=e+" | "+s.element.innerText,this.searchInputView.fieldView.element.focus()});const o=new t.ListItemView;return o.children.add(s),o}_createListIcons(e){const i=new t.ListView;return e.forEach(e=>{let t=Array.isArray(e.searchTerms)?e.searchTerms:Object.values(e.searchTerms),s=this._createIconBtn(e.title,t.join(" "));i.items.add(s)}),i}}class n extends e.Plugin{init(){const e=this.editor;this._balloon=this.editor.plugins.get(t.ContextualBalloon),this.formView=this._createFormView(),e.ui.componentFactory.add("flagIcons",i=>{const s=e.commands.get("InsertIconFlagCommand"),o=new t.ButtonView(i);return o.set({label:e.t("Flag icons"),icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-flag" viewBox="0 0 16 16">\n  <path d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001M14 1.221c-.22.078-.48.167-.766.255-.81.252-1.872.523-2.734.523-.886 0-1.592-.286-2.203-.534l-.008-.003C7.662 1.21 7.139 1 6.5 1c-.669 0-1.606.229-2.415.478A21.294 21.294 0 0 0 3 1.845v6.433c.22-.078.48-.167.766-.255C4.576 7.77 5.638 7.5 6.5 7.5c.847 0 1.548.28 2.158.525l.028.01C9.32 8.29 9.86 8.5 10.5 8.5c.668 0 1.606-.229 2.415-.478A21.317 21.317 0 0 0 14 7.655V1.222z"/>\n</svg>',tooltip:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{this._showUI()}),o})}_createFormView(){const e=this.editor,i=new o(e);return this.listenTo(i,"flagIcon",()=>{let t={icon:i.searchInputView.fieldView.element.value};e.execute("InsertIconFlagCommand",t),this._hideUI()}),this.listenTo(i,"submit",()=>{let t={icon:i.searchInputView.fieldView.element.value};e.execute("InsertIconFlagCommand",t),this._hideUI()}),this.listenTo(i,"cancel",()=>{this._hideUI()}),(0,t.clickOutsideHandler)({emitter:i,activator:()=>this._balloon.visibleView===i,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()}),i}_hideUI(){this.formView.searchInputView.fieldView.value="",this.formView.element.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus()}_showUI(){let e=sessionStorage.getItem("flagIconSearch");this.formView.searchInputView.fieldView.value=e,this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.focus()}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document;let i=null;return i=()=>e.domConverter.viewRangeToDom(t.selection.getFirstRange()),{target:i}}}var l=i("ckeditor5/src/widget.js");class r extends e.Command{execute(e){const{model:t}=this.editor,i=this.editor.config.get("flag_icons");let s=e.icon.split(" | ");t.change(t=>{let o=i.img?"":"fi ",n=s[0],l=s.pop();""!==e.icon&&(o+="fi-"+n),"1x1"==i.ratio&&(o+=" fis");const r={class:o};let c=`<img class="flag-img" height="25" src="${i.url}${n}.svg" alt="${l}"/>`;const a=t.createElement("flagIcons",r),d=t.createDocumentFragment();if(i.img){const e=this.editor.data.processor.toView(c),i=this.editor.data.toModel(e);t.append(i,a)}t.append(a,d),this.editor.model.insertContent(d)})}refresh(){const{model:e}=this.editor,{selection:t}=e.document,i=e.schema.findAllowedParent(t.getFirstPosition(),"flagIcons");this.isEnabled=null!==i}}class c extends e.Plugin{static get requires(){return[l.Widget]}init(){this._defineSchema(),this._defineConverters(),this._defineCommands()}_defineSchema(){this.editor.model.schema.register("flagIcons",{isObject:!0,allowWhere:"$text",isInline:!0,allowAttributes:["class"]})}_defineConverters(){const{conversion:e}=this.editor;e.attributeToAttribute({model:"class",view:"class"}),e.for("downcast").elementToElement({model:"flagIcons",view:"i"}),e.for("upcast").elementToElement({model:"flagIcons",view:{name:"i",classes:"flag-icons"}})}_defineCommands(){this.editor.commands.add("InsertIconFlagCommand",new r(this.editor))}}class a extends e.Plugin{static get requires(){return[c,n]}static get pluginName(){return"FlagIcons"}}const d={FlagIcons:a}})(),s=s.default})());